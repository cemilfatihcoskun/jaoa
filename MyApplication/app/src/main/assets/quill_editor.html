<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Quill Editor Full</title>

  <!--
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  -->

  <!-- Quill snow tema CSS -->
  <link href="quill.snow.css" rel="stylesheet" />

  <style>
	body {
		padding: 0;
		margin: 0;
	}
	
	@page {
	  size: A4;
	  margin: 40px 50px;
	}
	
    @font-face {
      font-family: 'jaoa_calibri';
      src: url('fonts/calibri.ttf') format('truetype');
    }

    @font-face {
      font-family: 'jaoa_arial';
      src: url('fonts/arial.ttf') format('truetype');
    }

    @font-face {
      font-family: 'jaoa_times_new_roman';
      src: url('fonts/times_new_roman.ttf') format('truetype');
    }

    body {
      margin: 0;
      font-family: jaoa_arial, sans-serif;
      font-size: 16px;
      
    }
    
    * {
		line-height: 1;
	}

    #toolbar {
      position: sticky;
      top: 0;
      background: #fff;
      z-index: 100;
      border-bottom: 1px solid #ccc;
      padding: 8px;
    }
    
	#editor-container {
		width: 794px;        /* A4 genişliği */
		height: auto;
		margin: 40px auto;   /* üst-alt boşluk + ortalama */
		padding: 16px;       /* içerik kenar boşluğu */
		font-family: Arial, sans-serif;
		font-size: 16px;
		
		border: 1px solid #ccc;  /* tüm kenarlar */
		box-sizing: border-box;   /* padding dahil etmesi için */
		overflow-y: visible !important;
	}

    
    .ql-lineheight {
	  width: 60px;
	}

    /* Quill font sınıfları */
    .ql-font-jaoa_calibri { font-family: jaoa_calibri, monospace; }
    .ql-font-jaoa_arial { font-family: jaoa_arial, sans-serif; }
    .ql-font-jaoa_times_new_roman { font-family: jaoa_times_new_roman, serif; }

    /* Yazı boyutu sınıfları */
    .ql-size-8pt { font-size: 11px; }
    .ql-size-9pt { font-size: 12px; }
    .ql-size-10pt { font-size: 13px; }
    .ql-size-11pt { font-size: 15px; }
    .ql-size-12pt { font-size: 16px; }
    .ql-size-14pt { font-size: 19px; }
    .ql-size-16pt { font-size: 22px; }
    .ql-size-18pt { font-size: 24px; }
    .ql-size-20pt { font-size: 26px; }
    .ql-size-22pt { font-size: 29px; }
    .ql-size-24pt { font-size: 32px; }
    .ql-size-26pt { font-size: 35px; }
    .ql-size-28pt { font-size: 37px; }
    .ql-size-36pt { font-size: 48px; }
    .ql-size-48pt { font-size: 64px; }
    .ql-size-72pt { font-size: 96px; }
    
   .ql-editor h1 {
	  font-size: 24px !important;
	  font-weight: bold;
  line-height: 1.15;
	}
	
	.ql-editor h2 {
	  font-size: 22px !important;
	  font-weight: bold;
  line-height: 1.15;
	}
	
	.ql-editor h3 {
	  font-size: 19px !important;
	  font-weight: bold;
  line-height: 1.15;
	}

.ql-editor {
    width: 794px;
    min-height: 1123px;
    margin: 0 auto;
    box-sizing: border-box;
    padding: 40px;
}

    
    .ql-lineheight option {
  color: black; /* Eğer görünmüyorsa beyaz kalıyor olabilir */
}

.ql-line-height {
	min-width: 60px;
}



.ql-line-height .ql-picker-item[data-value="1"]::before,
.ql-line-height .ql-picker-label[data-value="1"]::before {
 content: '1'!important ;
}

.ql-line-height .ql-picker-item[data-value="1.15"]::before,
.ql-line-height .ql-picker-label[data-value="1.15"]::before {
 content: '1.15'!important;
}

.ql-line-height .ql-picker-item[data-value="1.5"]::before,
.ql-line-height .ql-picker-label[data-value="1.5"]::before {
 content: '1.5'!important;
}

.ql-line-height .ql-picker-item[data-value="2"]::before,
.ql-line-height .ql-picker-label[data-value="2"]::before {
 content: '2'!important;
}

@media print {
  /* Toolbar ve imleçleri gizle */
  .ql-toolbar,
  .ql-cursor,
  .image-resize-overlay,
  .image-resize-display,
  .image-resize-toolbar {
    display: none !important;
    visibility: hidden !important;
  }

  /* Sayfa ayarları */
  @page {
    size: A4;
    margin: 0;
  }

  html, body {
    margin: 0 !important;
    padding: 0 !important;
    height: auto !important;
    overflow: visible !important;
    -webkit-print-color-adjust: exact;
  }

  /* Ana container ayarı */
  #editor-container {
    width: 794px; /* A4 genişliği */
    min-height: auto !important;
    height: auto !important;
    padding: 16px !important; /* İç padding sabit */
    margin: 0 auto !important;
    border: none !important;
    box-shadow: none !important;
    overflow: visible !important;
    page-break-inside: avoid;
    page-break-after: auto;
    overflow-y: visible !important;
  }

  /* Quill editör içeriği */
  .ql-editor {
    padding: 0 !important;
    margin: 0 !important;
    line-height: 1.2 !important;
    page-break-inside: auto;
    page-break-after: auto;
  }

  /* Son satır kırılmasını engelle */
  .ql-editor * {
    page-break-inside: avoid;
  }
}






  </style>
</head>
<body>

  <!-- Toolbar -->
  <div id="toolbar">
	<span class="ql-formats">
	  <select class="ql-header">
		<option selected></option>
		<option value="1">Başlık 1</option>
	    <option value="2">Başlık 2</option>
		<option value="3">Başlık 3</option>
	  </select>
	</span>
	
    <span class="ql-formats">
      <select class="ql-font">
        <option value="jaoa_calibri" selected>Calibri</option>
        <option value="jaoa_arial">Arial</option>
        <option value="jaoa_times_new_roman">Times New Roman</option>
      </select>
      
      <select class="ql-size">
        <option value="8pt">8pt</option>
        <option value="9pt">9pt</option>
        <option value="10pt">10pt</option>
        <option value="11pt">11pt</option>
        <option value="12pt" selected>12pt</option>
        <option value="14pt">14pt</option>
        <option value="16pt">16pt</option>
        <option value="18pt">18pt</option>
        <option value="20pt">20pt</option>
        <option value="22pt">22pt</option>
        <option value="24pt">24pt</option>
        <option value="26pt">26pt</option>
        <option value="28pt">28pt</option>
        <option value="36pt">36pt</option>
        <option value="48pt">48pt</option>
        <option value="72pt">72pt</option>
      </select>
      
      
    </span>
    
    <span class="ql-formats">
      <select class="ql-line-height">
        <option value="1" selected>1</option>
        <option value="1.15">1.15</option>
        <option value="1.5">1.5</option>
        <option value="2">2</option>
      </select>
    </span>

    <span class="ql-formats">
      <button class="ql-bold"></button>
      <button class="ql-italic"></button>
      <button class="ql-underline"></button>
      <button class="ql-strike"></button>
    </span>

    <span class="ql-formats">
      <select class="ql-color"></select>
      <select class="ql-background">
		<option selected></option>
		<option value="black"></option>
		<option value="blue"></option>
		<option value="cyan"></option>
		<option value="green"></option>
		<option value="magenta"></option>
		<option value="red"></option>
		<option value="yellow"></option>
		<option value="white"></option>
		<option value="darkBlue"></option>
		<option value="darkCyan"></option>
		<option value="darkGreen"></option>
		<option value="darkMagenta"></option>
		<option value="darkRed"></option>
		<option value="rgb(139, 128, 0)"></option>
		<option value="darkGray"></option>
		<option value="lightGray"></option>
	  </select>
    </span>

    <span class="ql-formats">
      <button class="ql-blockquote"></button>
      <button class="ql-code-block"></button>
      <select class="ql-align"></select>
    </span>

    <span class="ql-formats">
      <button class="ql-list" value="ordered"></button>
      <button class="ql-list" value="bullet"></button>
      <button class="ql-indent" value="-1"></button>
      <button class="ql-indent" value="+1"></button>
    </span>

    <span class="ql-formats">
      <button class="ql-link"></button>
      <button class="ql-image"></button>
      <button class="ql-video"></button>
    </span>

    <span class="ql-formats">
      <button class="ql-clean"></button>
    </span>
    
    
  </div>

  <!-- Editör Alanı -->
  <div id="editor-container"></div>

  <!-- Quill JS -->
  <script src="quill.js"></script>
  <script src="quill_image_resize_modified.js"></script>

  <script>
    // Font seçeneklerini tanımla
    var Font = Quill.import('formats/font');
    Font.whitelist = ['jaoa_calibri', 'jaoa_arial', 'jaoa_times_new_roman'];
    Quill.register(Font, true);

    // Boyut seçeneklerini px olarak ayarla
    var Size = Quill.import('formats/size');
    Size.whitelist = ['8pt', '9pt', '10pt', '11pt', '12pt', '14pt', '16pt', '18pt', '20pt', '22pt', '24pt', '26pt', '28pt', '36pt', '48pt', '72pt'];
    Quill.register(Size, true);

    // Satır aralığı formatı (line-height)
    var Parchment = window.Quill.import('parchment');
	const config = {
	  scope: Parchment.Scope.BLOCK,
	  whitelist: ['1','1.15','1.5','2']
	}
	var lineHtClass = new Parchment.Attributor.Class('line-height','ql-line-height', config);
	var lineHtStyle = new Parchment.Attributor.Style('line-height','line-height', config);

	Parchment.register(lineHtClass);
	Parchment.register(lineHtStyle);
	

  const quill = new Quill('#editor-container', {
    theme: 'snow',
    modules: {
      toolbar: '#toolbar',
      imageResize: {
        keepRatio: false  // veya true yapabilirsin
      }
    },
    
  });


    // Android'den içerik alma
   window.setHtmlContent = function(content, isInitial) {
	  try {
		quill.clipboard.dangerouslyPasteHTML(content);
		quill.history.clear();
	  } catch(e) {
		console.error("setHtmlContent error", e);
	  }
	};


    // Android'e içerik gönderme
    window.getHtmlContent = function() {
      const html = quill.root.innerHTML;
      if (window.AndroidInterface && window.AndroidInterface.receiveHtml) {
        window.AndroidInterface.receiveHtml(html);
      }
      return html;
    };

    // WebView odak problemi için tıklayınca odakla
    document.body.addEventListener('click', () => quill.focus());
    
    // Align değiştiğinde overlay güncelle
    const imageResize = quill.getModule('imageResize');
	quill.on('editor-change', function(eventName, ...args) {
	  if (eventName === 'text-change' || eventName === 'selection-change') {
		// Burada güncelleme tetikleyebilirsin.
		// Örneğin seçili resim varsa ve overlay açıksa:
		if (imageResize && imageResize.img) {
		  imageResize.onUpdate();
		}
	  }
	});
	
	quill.on('selection-change', function(range) {
	  if (range) {
		const format = quill.getFormat(range);
		if (format['line-height'] === '1') {
		  // Eğer hiç uygulanmadıysa (çünkü tarayıcı atlamış olabilir), zorla uygula
		  quill.format('line-height', '1');
		}
	  }
	});
	
	window.onload = function () {
	  if (window.AndroidInterface && window.AndroidInterface.onEditorReady) {
		window.AndroidInterface.onEditorReady();
	  }
	};

	
	


  </script>

</body>
</html>
